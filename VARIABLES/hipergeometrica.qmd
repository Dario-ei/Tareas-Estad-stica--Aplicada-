---
title: "Distribución Hipergeométrica"
lang: es
---

```{=html}
<style>
main.content {
text-align: justify}
</style>
```


```{r}
# =======================================================
# CAPÍTULO: Distribución Hipergeométrica - R
# =======================================================

# --- 1. Parámetros de ejemplo ---
N <- 20    # Tamaño población
K <- 7     # Número de éxitos en población
n <- 5     # Tamaño muestra

cat("Parámetros:\n")
cat("N =", N, "K =", K, "n =", n, "\n\n")

# =======================================================
# 2. Función de probabilidad (PMF)
# =======================================================
k <- 3  # Número de éxitos deseado
prob_k <- dhyper(k, K, N-K, n)
cat("Probabilidad de exactamente", k, "éxitos:", prob_k, "\n\n")

# =======================================================
# 3. Probabilidades acumuladas
# =======================================================
# P(X <= k)
prob_menor_igual <- phyper(k, K, N-K, n)
cat("Probabilidad de X <=", k, ":", prob_menor_igual, "\n")

# P(X >= k) = 1 - P(X <= k-1)
prob_mayor_igual <- 1 - phyper(k-1, K, N-K, n)
cat("Probabilidad de X >=", k, ":", prob_mayor_igual, "\n\n")

# =======================================================
# 4. Media y varianza
# =======================================================
mu <- n * K / N
varianza <- n * K / N * (N-K)/N * (N-n)/(N-1)
sigma <- sqrt(varianza)
cat("Media:", mu, "Varianza:", varianza, "Desviación estándar:", sigma, "\n\n")

# =======================================================
# 5. Simulación
# =======================================================
set.seed(123)
n_sim <- 10000
sim <- rhyper(n_sim, K, N-K, n)

# Frecuencias empíricas
freq_emp <- table(sim)/n_sim
cat("Frecuencias empíricas de la simulación:\n")
print(freq_emp)

# Histograma de simulación
barplot(freq_emp, col="lightblue", main="Distribución Hipergeométrica simulada",
        xlab="Número de éxitos", ylab="Frecuencia relativa")

# =======================================================
# 6. Comparación con Binomial aproximada
# =======================================================
p_bin <- K / N
pmf_binom <- dbinom(0:n, n, p_bin)

# Superponer binomial
points(0:n, pmf_binom, col="red", pch=19)
lines(0:n, pmf_binom, col="red", lwd=2)
legend("topright", legend=c("Simulación Hipergeométrica","Binomial aproximada"),
       col=c("lightblue","red"), lwd=c(NA,2), pch=c(NA,19), bty="n")

# =======================================================
# 7. Ejemplo avanzado: productos defectuosos
# =======================================================
N2 <- 50  # tamaño lote
K2 <- 10  # defectuosos
n2 <- 8   # inspeccionados

# Probabilidad de exactamente 2 defectuosos
prob2 <- dhyper(2, K2, N2-K2, n2)

# Media y desviación estándar
mu2 <- n2*K2/N2
sigma2 <- sqrt(n2*K2/N2 * (N2-K2)/N2 * (N2-n2)/(N2-1))

cat("\nEjemplo: Productos defectuosos\n")
cat("Probabilidad de exactamente 2 defectuosos:", prob2, "\n")
cat("Media:", mu2, "Desviación estándar:", sigma2, "\n")

```

